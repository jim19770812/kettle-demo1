<?xml version="1.0" encoding="UTF-8"?>
<repository>

<transformations>
<transformation>
  <info>
    <name>f_debt</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/csl_ktrfile</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2018/07/10 16:01:58.000</created_date>
    <modified_user>admin</modified_user>
    <modified_date>2018/07/30 17:00:21.000</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>olap_db</name>
    <server>127.0.0.1</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>olap_db</database>
    <port>3306</port>
    <username>olap</username>
    <password>Encrypted 774ae5bce9b92dd0dccff23d8849e983a98f</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>risk_db</name>
    <server>rm-bp1392iiq3s3630q9.mysql.rds.aliyuncs.com</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>risk_db</database>
    <port>3306</port>
    <username>risk_user</username>
    <password>Encrypted 6e694c66465a443f37643a517371364885fbdcfc0de0c7c28c34ef4afed78891</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.characterEncoding</code>
        <attribute>utf8</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>she_db</name>
    <server>rm-bp1392iiq3s3630q9.mysql.rds.aliyuncs.com</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>she_db</database>
    <port>3306</port>
    <username>she_userv</username>
    <password>Encrypted 765a7537506b7332564a476d6e75285c91ab929303e4c1df925de44bc5c8b79b</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>JavaScript代码</from>
      <to>字段选择 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码</from>
      <to>排序记录 3 </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date</from>
      <to>排序记录 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date 2</from>
      <to>字段选择 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>去除重复记录</from>
      <to>表输出</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 1</from>
      <to>d_date</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 1</from>
      <to>排序记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 2</from>
      <to>合并记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 3</from>
      <to>记录集连接 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 4</from>
      <to>d_date 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 5</from>
      <to>合并记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录</from>
      <to>记录集连接</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 2</from>
      <to>记录集连接</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3 </from>
      <to>去除重复记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 4</from>
      <to>记录集连接 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>表输出</from>
      <to>排序记录 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接</from>
      <to>过滤记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 2</from>
      <to>字段选择 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录</from>
      <to>JavaScript代码</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录</from>
      <to>字段选择 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3</from>
      <to>记录集连接 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3</from>
      <to>字段选择 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 6</from>
      <to>user_login_record</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_login_record</from>
      <to>d_phone_type</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_phone_type</from>
      <to>排序记录 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 5</from>
      <to>分组</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3</from>
      <to>记录集连接 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组</from>
      <to>记录集连接 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_debt</from>
      <to>字段选择</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择</from>
      <to>f_user_basic</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_debt</from>
      <to>排序记录 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>f_user_basic</from>
      <to>排序记录 8</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 7</from>
      <to>记录集连接 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 8</from>
      <to>记录集连接 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 5</from>
      <to>字段选择 1</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 5</from>
      <to>排序记录 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 4</from>
      <to>替换NULL值</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>替换NULL值</from>
      <to>f_debt</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>合并记录</from>
      <to>排序记录 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 6</from>
      <to>记录集连接 3</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>JavaScript代码</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
function getNowFormatDate() {
    var date = new Date();
    var seperator1 = "-";
    var seperator2 = ":";
    var month = date.getMonth() + 1;
    var strDate = date.getDate();
    if (month >= 1 &amp;&amp; month &lt;= 9) {
        month = "0" + month;
    }
    if (strDate >= 0 &amp;&amp; strDate &lt;= 9) {
        strDate = "0" + strDate;
    }
    var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + date.getHours() + seperator2 + date.getMinutes()
            + seperator2 + date.getSeconds();
    return currentdate;
}
// 定义一个判断函数
function inArray(needle, haystack) {
    var length = haystack.length;
    for(var i = 0; i &lt; length; i++) {
        if(haystack[i] == needle) return true;
    }
    return false;
}
var cliname = 'SHE';
var org_id = 108;
var ctime = getNowFormatDate();
var d_year = ud_time.substr(0,4);
var d_month = ud_time.substr(5,2);
var arr = Array('01','02','03','04','05','06');
var is_half_year = inArray(d_month,arr);
if(is_half_year){
	var d_half_year = 0;
}else{
	var d_half_year = 1;
}
var quarter1 = inArray(d_month,Array('01','02','03'));
if(quarter1){
	var d_quarter = 1;
}
var quarter2 = inArray(d_month,Array('04','05','06'));
if(quarter2){
	var d_quarter = 2;
}
var quarter3 = inArray(d_month,Array('07','08','09'));
if(quarter3){
	var d_quarter = 3;
}
var quarter4 = inArray(d_month,Array('10','11','12'));
if(quarter4){
	var d_quarter = 4;
}
var d_day = ud_time.substr(8,2);
var d_hour = ud_time.substr(-8,2);
var d_sec = ud_time.substr(-5,2);
var d_datetime = d_year+d_month+d_day+d_hour+d_sec;
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>cliname</name>
        <rename>cliname</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>org_id</name>
        <rename>org_id</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ctime</name>
        <rename>ctime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_year</name>
        <rename>d_year</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_month</name>
        <rename>d_month</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_half_year</name>
        <rename>d_half_year</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_quarter</name>
        <rename>d_quarter</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_day</name>
        <rename>d_day</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_hour</name>
        <rename>d_hour</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_sec</name>
        <rename>d_sec</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_datetime</name>
        <rename>d_datetime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>896</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
  d_id
,? as ud_id
, d_datetime
FROM d_date
where d_datetime=date_format(?,'%Y%m%d%H%i')</sql>
    <limit>0</limit>
    <lookup>字段选择 1</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>640</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
? as ud_id
, d_id
, d_datetime
FROM d_date
where d_datetime=?</sql>
    <limit>0</limit>
    <lookup>字段选择 4</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1216</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_phone_type</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 ? as ud_id
, pt_id
, pt_fac_price
FROM d_phone_type
where pt_model=?
</sql>
    <limit>0</limit>
    <lookup>user_login_record</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1312</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_debt</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>f_debt</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>u_id</column_name>
        <stream_name>u_id</stream_name>
      </field>
      <field>
        <column_name>a_id</column_name>
        <stream_name>user_id_address_a_id</stream_name>
      </field>
      <field>
        <column_name>pt_id</column_name>
        <stream_name>pt_id</stream_name>
      </field>
      <field>
        <column_name>d_id</column_name>
        <stream_name>d_id</stream_name>
      </field>
      <field>
        <column_name>user_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>create_time</column_name>
        <stream_name>create_time</stream_name>
      </field>
      <field>
        <column_name>db_is_overdue</column_name>
        <stream_name>ud_breach</stream_name>
      </field>
      <field>
        <column_name>db_overdue_day_cnt</column_name>
        <stream_name>ud_overdue_daycount</stream_name>
      </field>
      <field>
        <column_name>db_ud_id</column_name>
        <stream_name>ud_id</stream_name>
      </field>
      <field>
        <column_name>db_ul_id</column_name>
        <stream_name>ul_id</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>848</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_user_basic</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 ? as ud_id
, u_user_id
, u_id
, user_id_address_a_id
FROM f_user_basic
where org_id=? and u_user_id=?</sql>
    <limit>0</limit>
    <lookup>字段选择</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>320</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_debt</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>she_db</connection>
    <sql>SELECT
 ud_id
, ul_id
, cliname
, org_id
, user_id
, now() as create_time
, from_unixtime(ud_time) as ud_time
, ud_breach
, ud_overdue_daycount
FROM user_debt where ud_time&lt;unix_timestamp('2018-07-19 00:00:00') limit 30000,10000</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_login_record</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
 ? as ud_id
, ulgnr_vendor
FROM user_login_record
where org_id=? and user_id=? and ulgnr_vendor&lt;&gt;''
group by ulgnr_vendor
</sql>
    <limit>0</limit>
    <lookup>字段选择 6</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>Y</give_back_row>
    <group>
      <field>
        <name>ud_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>pt_fac_price</aggregate>
        <subject>pt_fac_price</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>pt_id</aggregate>
        <subject>pt_id</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1312</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>去除重复记录</name>
    <type>Unique</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <count_rows>N</count_rows>
    <count_field/>
    <reject_duplicate_row>N</reject_duplicate_row>
    <error_description/>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <case_insensitive>N</case_insensitive>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1104</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>合并记录</name>
    <type>MergeRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <keys>
      <key>ud_id</key>
    </keys>
    <values>
      <value>ud_id</value>
    </values>
    <flag_field>flagfield</flag_field>
    <reference>字段选择 2</reference>
    <compare>字段选择 5</compare>
    <compare>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>org_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>208</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 1</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>ud_time</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>ud_time</name>
        <rename>ud_time</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd HH:mm:ss</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>640</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>896</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 3</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>d_datetime_1</name>
        <rename>d_datetime</rename>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 4</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1312</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 5</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>ud_id</name>
        <rename>ud_id</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1104</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 6</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>org_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1104</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>640</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3 </name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 4</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1312</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 5</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>pt_fac_price</name>
        <ascending>N</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1312</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 6</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 7</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 8</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>替换NULL值</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>pt_id</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>表输出</name>
    <type>TableOutput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>d_date</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>create_time</column_name>
        <stream_name>ud_time</stream_name>
      </field>
      <field>
        <column_name>d_datetime</column_name>
        <stream_name>d_datetime_1</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>d_year</column_name>
        <stream_name>d_year</stream_name>
      </field>
      <field>
        <column_name>d_month</column_name>
        <stream_name>d_month</stream_name>
      </field>
      <field>
        <column_name>d_half_year</column_name>
        <stream_name>d_half_year</stream_name>
      </field>
      <field>
        <column_name>d_quarter</column_name>
        <stream_name>d_quarter</stream_name>
      </field>
      <field>
        <column_name>d_day</column_name>
        <stream_name>d_day</stream_name>
      </field>
      <field>
        <column_name>d_hour</column_name>
        <stream_name>d_hour</stream_name>
      </field>
      <field>
        <column_name>d_sec</column_name>
        <stream_name>d_sec</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1216</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>排序记录</step1>
    <step2>排序记录 2</step2>
    <keys_1>
      <key>ud_id</key>
    </keys_1>
    <keys_2>
      <key>ud_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 2</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>字段选择 3</step1>
    <step2>排序记录 4</step2>
    <keys_1>
      <key>ud_id</key>
    </keys_1>
    <keys_2>
      <key>ud_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1312</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 3</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>排序记录 3</step1>
    <step2>排序记录 6</step2>
    <keys_1>
      <key>ud_id</key>
    </keys_1>
    <keys_2>
      <key>ud_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 4</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>记录集连接 3</step1>
    <step2>分组</step2>
    <keys_1>
      <key>ud_id</key>
    </keys_1>
    <keys_2>
      <key>ud_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 5</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>排序记录 7</step1>
    <step2>排序记录 8</step2>
    <keys_1>
      <key>ud_id</key>
    </keys_1>
    <keys_2>
      <key>ud_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>过滤记录</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>字段选择 2</send_true_to>
    <send_false_to>JavaScript代码</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>d_id</leftvalue>
        <function>IS NOT NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>

<transformation>
  <info>
    <name>f_identify</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/csl_ktrfile</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2018/07/11 16:55:26.000</created_date>
    <modified_user>admin</modified_user>
    <modified_date>2018/08/03 10:30:57.000</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>olap_db</name>
    <server>127.0.0.1</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>olap_db</database>
    <port>3306</port>
    <username>olap</username>
    <password>Encrypted 774ae5bce9b92dd0dccff23d8849e983a98f</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>risk_db</name>
    <server>rm-bp1392iiq3s3630q9.mysql.rds.aliyuncs.com</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>risk_db</database>
    <port>3306</port>
    <username>risk_user</username>
    <password>Encrypted 6e694c66465a443f37643a517371364885fbdcfc0de0c7c28c34ef4afed78891</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.characterEncoding</code>
        <attribute>utf8</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>JavaScript代码</from>
      <to>字段选择 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码</from>
      <to>排序记录 3 </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date</from>
      <to>排序记录 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date 2</from>
      <to>字段选择 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>去除重复记录</from>
      <to>表输出</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 1</from>
      <to>d_date</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 1</from>
      <to>排序记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 2</from>
      <to>合并记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 3</from>
      <to>记录集连接 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 4</from>
      <to>d_date 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 5</from>
      <to>合并记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录</from>
      <to>记录集连接</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 2</from>
      <to>记录集连接</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3 </from>
      <to>去除重复记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 4</from>
      <to>记录集连接 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>表输出</from>
      <to>排序记录 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接</from>
      <to>过滤记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 2</from>
      <to>字段选择 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录</from>
      <to>JavaScript代码</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录</from>
      <to>字段选择 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>f_user_basic</from>
      <to>user_identify_record</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_identify_record</from>
      <to>字段选择 1</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_identify_record</from>
      <to>排序记录 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>合并记录</from>
      <to>排序记录 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3</from>
      <to>记录集连接 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 5</from>
      <to>记录集连接 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_phone_type</from>
      <to>排序记录 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_login_record</from>
      <to>d_phone_type</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 6</from>
      <to>user_login_record</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 6</from>
      <to>分组</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3</from>
      <to>字段选择 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3</from>
      <to>记录集连接 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组</from>
      <to>记录集连接 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 4</from>
      <to>字段选择</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择</from>
      <to>user_face_sanpshot</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_face_sanpshot</from>
      <to>分组 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 4</from>
      <to>排序记录 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 7</from>
      <to>记录集连接 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码 2</from>
      <to>替换NULL值</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>替换NULL值</from>
      <to>表输出 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择</from>
      <to>user_face_sanpshot 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_face_sanpshot 2</from>
      <to>分组 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择</from>
      <to>user_face_sanpshot 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_face_sanpshot 3</from>
      <to>分组 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组 2</from>
      <to>排序记录 8</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组 3</from>
      <to>排序记录 9</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组 4</from>
      <to>排序记录 10</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 8</from>
      <to>记录集连接 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 5</from>
      <to>记录集连接 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 9</from>
      <to>记录集连接 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 6</from>
      <to>记录集连接 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 10</from>
      <to>记录集连接 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 7</from>
      <to>JavaScript代码 2</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>JavaScript代码</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
function getNowFormatDate() {
    var date = new Date();
    var seperator1 = "-";
    var seperator2 = ":";
    var month = date.getMonth() + 1;
    var strDate = date.getDate();
    if (month >= 1 &amp;&amp; month &lt;= 9) {
        month = "0" + month;
    }
    if (strDate >= 0 &amp;&amp; strDate &lt;= 9) {
        strDate = "0" + strDate;
    }
    var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + date.getHours() + seperator2 + date.getMinutes()
            + seperator2 + date.getSeconds();
    return currentdate;
}
// 定义一个判断函数
function inArray(needle, haystack) {
    var length = haystack.length;
    for(var i = 0; i &lt; length; i++) {
        if(haystack[i] == needle) return true;
    }
    return false;
}
var cliname = 'SHE';
var org_id = 108;
var ctime = getNowFormatDate();
var d_year = create_time.substr(0,4);
var d_month = create_time.substr(5,2);
var arr = Array('01','02','03','04','05','06');
var is_half_year = inArray(d_month,arr);
if(is_half_year){
	var d_half_year = 0;
}else{
	var d_half_year = 1;
}
var quarter1 = inArray(d_month,Array('01','02','03'));
if(quarter1){
	var d_quarter = 1;
}
var quarter2 = inArray(d_month,Array('04','05','06'));
if(quarter2){
	var d_quarter = 2;
}
var quarter3 = inArray(d_month,Array('07','08','09'));
if(quarter3){
	var d_quarter = 3;
}
var quarter4 = inArray(d_month,Array('10','11','12'));
if(quarter4){
	var d_quarter = 4;
}
var d_day = create_time.substr(8,2);
var d_hour = create_time.substr(-8,2);
var d_sec = create_time.substr(-5,2);
var d_datetime = d_year+d_month+d_day+d_hour+d_sec;
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>cliname</name>
        <rename>cliname</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>org_id</name>
        <rename>org_id</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ctime</name>
        <rename>ctime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_year</name>
        <rename>d_year</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_month</name>
        <rename>d_month</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_half_year</name>
        <rename>d_half_year</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_quarter</name>
        <rename>d_quarter</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_day</name>
        <rename>d_day</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_hour</name>
        <rename>d_hour</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_sec</name>
        <rename>d_sec</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_datetime</name>
        <rename>d_datetime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JavaScript代码 2</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
function unique(arr){
 var res = [arr[0]];
 for(var i=1; i&lt;arr.length; i++){
  var repeat = false;
  for(var j=0; j&lt;res.length; j++){
   if(arr[i] === res[j]){
    repeat = true;
    break;
   }
  }
  if(!repeat){
   res.push(arr[i]);
  }
 }
 return res;
}

if(device_type){
	var strs = device_type.split(',');
	var str = unique(strs);
	if(str == 1){
    	var idf_identify_device_type = 1;//Android
	}else if(str == 2){
		var idf_identify_device_type = 2;//IOS
	}else{
		var idf_identify_device_type = 3;//Android+IOS
	}
}else{
 	var idf_identify_device_type = -1;
}

</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>idf_identify_device_type</name>
        <rename>idf_identify_device_type</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1104</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
  d_id
,? as u_id
, d_datetime
FROM d_date
where d_datetime=date_format(?,'%Y%m%d%H%i')</sql>
    <limit>0</limit>
    <lookup>字段选择 1</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
? as u_id
, d_id
, d_datetime
FROM d_date
where d_datetime=?</sql>
    <limit>0</limit>
    <lookup>字段选择 4</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1024</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_phone_type</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 ? as u_id
, pt_id
, pt_fac_price
, ? as ulgnr_source
FROM d_phone_type
where pt_model=?
</sql>
    <limit>0</limit>
    <lookup>user_login_record</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_user_basic</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 u_id
, user_id_address_a_id as a_id
, cliname
, org_id
, u_user_id as user_id
FROM f_user_basic limit 420000,10000</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_face_sanpshot</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
  ? as u_id
, user_id
FROM user_face_sanpshot where org_id=? and user_id=?
</sql>
    <limit>0</limit>
    <lookup>字段选择</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_face_sanpshot 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
  ? as u_id
, user_id
, ufcs_comp_score
FROM user_face_sanpshot where org_id=? and user_id=? and ufcs_check_gongan=1
</sql>
    <limit>0</limit>
    <lookup>字段选择</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_face_sanpshot 3</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
  ? as u_id
, user_id
, ufcs_hack_score
FROM user_face_sanpshot where org_id=? and user_id=? and ufcs_hack_score>0
</sql>
    <limit>0</limit>
    <lookup>字段选择</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>976</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_identify_record</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
  ? as u_id
, ? as a_id
, ? as cliname
, from_unixtime(create_time) as create_time
, org_id
, user_id
, category
FROM user_identify_record
where uir_type=7 and org_id=? and user_id=? order by create_time limit 1

</sql>
    <limit>0</limit>
    <lookup>f_user_basic</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_login_record</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
 ? as u_id
, ulgnr_source
, ulgnr_vendor
FROM user_login_record
where org_id=? and user_id=? and ulgnr_vendor&lt;&gt;''
group by ulgnr_vendor
</sql>
    <limit>0</limit>
    <lookup>字段选择 6</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>Y</give_back_row>
    <group>
      <field>
        <name>u_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>pt_fac_price</aggregate>
        <subject>pt_fac_price</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>pt_id</aggregate>
        <subject>pt_id</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>device_type</aggregate>
        <subject>ulgnr_source</subject>
        <type>CONCAT_COMMA</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组 2</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>u_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>idf_hs_facecheck_cnt</aggregate>
        <subject>user_id</subject>
        <type>COUNT_ALL</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组 3</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>u_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>idf_hs_facecheck_gongan_score</aggregate>
        <subject>ufcs_comp_score</subject>
        <type>AVERAGE</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组 4</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>u_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>idf_hs_facecheck_hack_score</aggregate>
        <subject>ufcs_hack_score</subject>
        <type>AVERAGE</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>976</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>去除重复记录</name>
    <type>Unique</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <count_rows>N</count_rows>
    <count_field/>
    <reject_duplicate_row>N</reject_duplicate_row>
    <error_description/>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <case_insensitive>N</case_insensitive>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>合并记录</name>
    <type>MergeRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <keys>
      <key>u_id</key>
    </keys>
    <values>
      <value>u_id</value>
    </values>
    <flag_field>flagfield</flag_field>
    <reference>字段选择 2</reference>
    <compare>字段选择 5</compare>
    <compare>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>org_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 1</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>create_time</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>create_time</name>
        <rename>create_time</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd HH:mm:ss</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 3</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>d_datetime_1</name>
        <rename>d_datetime</rename>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 4</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1120</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 5</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>u_id</name>
        <rename>u_id</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 6</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>org_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>544</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 10</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>976</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>544</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3 </name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 4</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1120</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 5</name>
    <type>SortRows</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 6</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>pt_fac_price</name>
        <ascending>N</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 7</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 8</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 9</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>替换NULL值</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>idf_hs_facecheck_cnt</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>idf_hs_facecheck_gongan_score</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>idf_hs_facecheck_hack_score</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>pt_id</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1216</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>表输出</name>
    <type>TableOutput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>d_date</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>create_time</column_name>
        <stream_name>create_time</stream_name>
      </field>
      <field>
        <column_name>d_datetime</column_name>
        <stream_name>d_datetime_1</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>d_year</column_name>
        <stream_name>d_year</stream_name>
      </field>
      <field>
        <column_name>d_month</column_name>
        <stream_name>d_month</stream_name>
      </field>
      <field>
        <column_name>d_half_year</column_name>
        <stream_name>d_half_year</stream_name>
      </field>
      <field>
        <column_name>d_quarter</column_name>
        <stream_name>d_quarter</stream_name>
      </field>
      <field>
        <column_name>d_day</column_name>
        <stream_name>d_day</stream_name>
      </field>
      <field>
        <column_name>d_hour</column_name>
        <stream_name>d_hour</stream_name>
      </field>
      <field>
        <column_name>d_sec</column_name>
        <stream_name>d_sec</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1024</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>表输出 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>f_identify</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>u_id</column_name>
        <stream_name>u_id</stream_name>
      </field>
      <field>
        <column_name>a_id</column_name>
        <stream_name>a_id</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>create_time</column_name>
        <stream_name>create_time</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>user_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>d_id</column_name>
        <stream_name>d_id</stream_name>
      </field>
      <field>
        <column_name>pt_id</column_name>
        <stream_name>pt_id</stream_name>
      </field>
      <field>
        <column_name>idf_hs_facecheck_cnt</column_name>
        <stream_name>idf_hs_facecheck_cnt</stream_name>
      </field>
      <field>
        <column_name>idf_hs_facecheck_gongan_score</column_name>
        <stream_name>idf_hs_facecheck_gongan_score</stream_name>
      </field>
      <field>
        <column_name>idf_hs_facecheck_hack_score</column_name>
        <stream_name>idf_hs_facecheck_hack_score</stream_name>
      </field>
      <field>
        <column_name>idf_identify_device_type</column_name>
        <stream_name>idf_identify_device_type</stream_name>
      </field>
      <field>
        <column_name>idf_category</column_name>
        <stream_name>category</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1328</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>排序记录</step1>
    <step2>排序记录 2</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>544</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 2</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>字段选择 3</step1>
    <step2>排序记录 4</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1120</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 3</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>排序记录 3</step1>
    <step2>排序记录 5</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 4</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>记录集连接 3</step1>
    <step2>分组</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 5</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>排序记录 7</step1>
    <step2>排序记录 8</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 6</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>记录集连接 5</step1>
    <step2>排序记录 9</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 7</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>记录集连接 6</step1>
    <step2>排序记录 10</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>976</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>过滤记录</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>字段选择 2</send_true_to>
    <send_false_to>JavaScript代码</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>d_id</leftvalue>
        <function>IS NOT NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>624</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>

<transformation>
  <info>
    <name>f_loan</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/csl_ktrfile</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2018/07/18 10:57:45.000</created_date>
    <modified_user>admin</modified_user>
    <modified_date>2018/08/06 13:59:58.000</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>notice_db</name>
    <server>rm-bp1392iiq3s3630q9.mysql.rds.aliyuncs.com:3306</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>notice_db</database>
    <port>3306</port>
    <username>notice_user</username>
    <password>Encrypted 4e787154706424417632287e5974626c8baecdf759c0b3bafc12eb33f8ad87c9</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>olap_db</name>
    <server>127.0.0.1</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>olap_db</database>
    <port>3306</port>
    <username>olap</username>
    <password>Encrypted 774ae5bce9b92dd0dccff23d8849e983a98f</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>risk_db</name>
    <server>rm-bp1392iiq3s3630q9.mysql.rds.aliyuncs.com</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>risk_db</database>
    <port>3306</port>
    <username>risk_user</username>
    <password>Encrypted 6e694c66465a443f37643a517371364885fbdcfc0de0c7c28c34ef4afed78891</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.characterEncoding</code>
        <attribute>utf8</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>she_db</name>
    <server>rm-bp1392iiq3s3630q9.mysql.rds.aliyuncs.com</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>she_db</database>
    <port>3306</port>
    <username>she_userv</username>
    <password>Encrypted 765a7537506b7332564a476d6e75285c91ab929303e4c1df925de44bc5c8b79b</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>user_loan</from>
      <to>f_user_basic</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码</from>
      <to>字段选择 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码</from>
      <to>排序记录 3 </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date</from>
      <to>排序记录 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date 2</from>
      <to>字段选择 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>去除重复记录</from>
      <to>表输出</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择</from>
      <to>d_date</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择</from>
      <to>排序记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 1</from>
      <to>合并记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 2</from>
      <to>记录集连接 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 3</from>
      <to>d_date 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 4</from>
      <to>合并记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录</from>
      <to>记录集连接</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 2</from>
      <to>记录集连接</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3 </from>
      <to>去除重复记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 4</from>
      <to>记录集连接 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>表输出</from>
      <to>排序记录 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接</from>
      <to>过滤记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 2</from>
      <to>字段选择 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录</from>
      <to>JavaScript代码</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录</from>
      <to>字段选择 1</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>f_user_basic</from>
      <to>字段选择</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>合并记录</from>
      <to>排序记录 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3</from>
      <to>记录集连接 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 6</from>
      <to>记录集连接 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>f_user_basic</from>
      <to>JavaScript代码 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码 2</from>
      <to>排序记录 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_phone_type</from>
      <to>排序记录 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3</from>
      <to>记录集连接 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_login_record</from>
      <to>d_phone_type</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组</from>
      <to>记录集连接 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 5</from>
      <to>user_login_record</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3</from>
      <to>字段选择 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 5</from>
      <to>分组</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 4</from>
      <to>字段选择 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 6</from>
      <to>user_loan 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 6</from>
      <to>排序记录 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_loan 2</from>
      <to>排序记录 8</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 7</from>
      <to>记录集连接 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 8</from>
      <to>记录集连接 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 5</from>
      <to>字段选择 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 7</from>
      <to>JavaScript代码 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 4</from>
      <to>记录集连接 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码 3</from>
      <to>记录集连接 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_notice</from>
      <to>记录集连接 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 8</from>
      <to>user_notice</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>替换NULL值</from>
      <to>f_loan</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 7</from>
      <to>替换NULL值</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 6</from>
      <to>字段选择 8</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 6</from>
      <to>记录集连接 7</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>JavaScript代码</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
function getNowFormatDate() {
    var date = new Date();
    var seperator1 = "-";
    var seperator2 = ":";
    var month = date.getMonth() + 1;
    var strDate = date.getDate();
    if (month >= 1 &amp;&amp; month &lt;= 9) {
        month = "0" + month;
    }
    if (strDate >= 0 &amp;&amp; strDate &lt;= 9) {
        strDate = "0" + strDate;
    }
    var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + date.getHours() + seperator2 + date.getMinutes()
            + seperator2 + date.getSeconds();
    return currentdate;
}
// 定义一个判断函数
function inArray(needle, haystack) {
    var length = haystack.length;
    for(var i = 0; i &lt; length; i++) {
        if(haystack[i] == needle) return true;
    }
    return false;
}
var cliname = 'SHE';
var org_id = 108;
var ctime = getNowFormatDate();
var d_year = ul_loan_time.substr(0,4);
var d_month = ul_loan_time.substr(5,2);
var arr = Array('01','02','03','04','05','06');
var is_half_year = inArray(d_month,arr);
if(is_half_year){
	var d_half_year = 0;
}else{
	var d_half_year = 1;
}
var quarter1 = inArray(d_month,Array('01','02','03'));
if(quarter1){
	var d_quarter = 1;
}
var quarter2 = inArray(d_month,Array('04','05','06'));
if(quarter2){
	var d_quarter = 2;
}
var quarter3 = inArray(d_month,Array('07','08','09'));
if(quarter3){
	var d_quarter = 3;
}
var quarter4 = inArray(d_month,Array('10','11','12'));
if(quarter4){
	var d_quarter = 4;
}
var d_day = ul_loan_time.substr(8,2);
var d_hour = ul_loan_time.substr(-8,2);
var d_sec = ul_loan_time.substr(-5,2);
var d_datetime = d_year+d_month+d_day+d_hour+d_sec;
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>cliname</name>
        <rename>cliname</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>org_id</name>
        <rename>org_id</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ctime</name>
        <rename>ctime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_year</name>
        <rename>d_year</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_month</name>
        <rename>d_month</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_half_year</name>
        <rename>d_half_year</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_quarter</name>
        <rename>d_quarter</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_day</name>
        <rename>d_day</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_hour</name>
        <rename>d_hour</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_sec</name>
        <rename>d_sec</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_datetime</name>
        <rename>d_datetime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>752</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JavaScript代码 2</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
var d_hour = ul_loan_time.substr(-8,2);
var d_min = ul_loan_time.substr(-5,2);
var d_sec = ul_loan_time.substr(-2,2);
var stamp = (d_hour*3600)+(d_min*60)+d_sec*1;
if(stamp>84600 || (stamp>=0 &amp;&amp; stamp&lt;=5400)){//1：[23:30:01-1:30:00]
	var lo_time_type = 1;
}
if(stamp>5400 &amp;&amp; stamp&lt;=19800){//5：[1:30:01-5:30:00]
	var lo_time_type = 5;
}
if(stamp>19800 &amp;&amp; stamp&lt;=32400){//9：[5:30:01~9:00:00]
	var lo_time_type = 9;
}
if(stamp>32400 &amp;&amp; stamp&lt;=41400){//11：[9:00:01-11:30:00]
	var lo_time_type = 11;
}
if(stamp>41400 &amp;&amp; stamp&lt;=48600){//13：[11:30:01-13:30:00]
	var lo_time_type = 13;
}
if(stamp>48600 &amp;&amp; stamp&lt;=63000){//17：[13:30:01-17:30:00]
	var lo_time_type = 17;
}
if(stamp>63000 &amp;&amp; stamp&lt;=70200){//19：[17:30:01-19:30:00]
	var lo_time_type = 19;
}
if(stamp>70200 &amp;&amp; stamp&lt;=84600){//23：[19:30:01-23:30:00]
	var lo_time_type = 23;
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>lo_time_type</name>
        <rename>lo_time_type</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>352</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JavaScript代码 3</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>
if(ul_repay_complete_time!=null){
	var lo_loan_interval_hours = Math.floor((loan_time_stamp-ul_repay_complete_time)/60/60);
}else{
	var lo_loan_interval_hours = -1;
}
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>lo_loan_interval_hours</name>
        <rename>lo_loan_interval_hours</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>560</xloc>
      <yloc>832</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
  d_id
,? as ul_id
, d_datetime
FROM d_date
where d_datetime=date_format(?,'%Y%m%d%H%i')</sql>
    <limit>0</limit>
    <lookup>字段选择</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
? as ul_id
, d_id
, d_datetime
FROM d_date
where d_datetime=?</sql>
    <limit>0</limit>
    <lookup>字段选择 3</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1072</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_phone_type</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 ? as ul_id
, pt_id
, pt_fac_price
FROM d_phone_type
where pt_model=?
</sql>
    <limit>0</limit>
    <lookup>user_login_record</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>112</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_loan</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>f_loan</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>a_id</column_name>
        <stream_name>a_id</stream_name>
      </field>
      <field>
        <column_name>pt_id</column_name>
        <stream_name>pt_id</stream_name>
      </field>
      <field>
        <column_name>d_id</column_name>
        <stream_name>d_id</stream_name>
      </field>
      <field>
        <column_name>u_id</column_name>
        <stream_name>u_id</stream_name>
      </field>
      <field>
        <column_name>user_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>create_time</column_name>
        <stream_name>create_time</stream_name>
      </field>
      <field>
        <column_name>lo_loan_interval_hours</column_name>
        <stream_name>lo_loan_interval_hours</stream_name>
      </field>
      <field>
        <column_name>lo_time_type</column_name>
        <stream_name>lo_time_type</stream_name>
      </field>
      <field>
        <column_name>db_ul_id</column_name>
        <stream_name>ul_id</stream_name>
      </field>
      <field>
        <column_name>lo_viewed_notice</column_name>
        <stream_name>lo_viewed_notice</stream_name>
      </field>
      <field>
        <column_name>lo_delete_notice</column_name>
        <stream_name>lo_delete_notice</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>944</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_user_basic</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 ? as ul_id
, cliname
, org_id
, u_user_id as user_id
, u_id
, user_id_address_a_id as a_id
, now() as create_time
, ? as ul_loan_time
, ? as loan_time_stamp
FROM f_user_basic
where org_id=? and u_user_id=?</sql>
    <limit>0</limit>
    <lookup>user_loan</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>352</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_loan</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>she_db</connection>
    <sql>SELECT
  ul_id
, from_unixtime(ul_loan_time) as ul_loan_time
, ul_loan_time as loan_time_stamp
, org_id
, user_id
FROM user_loan where ul_loan_time&lt;unix_timestamp('2018-07-19 00:00:00') limit 30000,10000</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>112</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_loan 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>she_db</connection>
    <sql>SELECT
  ? as ul_id
, ul_repay_complete_time
FROM user_loan
WHERE user_id=? and ul_loan_status=3 and ul_repay_complete_time&lt;?
order by ul_repay_complete_time desc limit 1
</sql>
    <limit>0</limit>
    <lookup>字段选择 6</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_login_record</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
 ? as ul_id
, ulgnr_vendor
FROM user_login_record
where org_id=? and user_id=? and ulgnr_vendor&lt;&gt;''
group by ulgnr_vendor
</sql>
    <limit>0</limit>
    <lookup>字段选择 5</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_notice</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>notice_db</connection>
    <sql>SELECT
 un_jump_id as ul_id
, un_remind as lo_viewed_notice
, un_status as lo_delete_notice
FROM user_notice where org_id=? and un_type='LON' and un_src_user_id=? and un_jump_id=? limit 1
</sql>
    <limit>0</limit>
    <lookup>字段选择 8</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>Y</give_back_row>
    <group>
      <field>
        <name>ul_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>pt_fac_price</aggregate>
        <subject>pt_fac_price</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>pt_id</aggregate>
        <subject>pt_id</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>去除重复记录</name>
    <type>Unique</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <count_rows>N</count_rows>
    <count_field/>
    <reject_duplicate_row>N</reject_duplicate_row>
    <error_description/>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <case_insensitive>N</case_insensitive>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>960</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>合并记录</name>
    <type>MergeRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <keys>
      <key>ul_id</key>
    </keys>
    <values>
      <value>ul_id</value>
    </values>
    <flag_field>flagfield</flag_field>
    <reference>字段选择 1</reference>
    <compare>字段选择 4</compare>
    <compare>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ul_id</name>
      </field>
      <field>
        <name>ul_loan_time</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>ul_loan_time</name>
        <rename>ul_loan_time</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd HH:mm:ss</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 1</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ul_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>752</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ul_id</name>
      </field>
      <field>
        <name>d_datetime_1</name>
        <rename>d_datetime</rename>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 3</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ul_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 4</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ul_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>ul_id</name>
        <rename>ul_id</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>960</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 5</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ul_id</name>
      </field>
      <field>
        <name>org_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 6</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ul_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <field>
        <name>loan_time_stamp</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 7</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ul_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <field>
        <name>loan_time_stamp</name>
      </field>
      <field>
        <name>ul_repay_complete_time</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>832</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 8</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>org_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <field>
        <name>ul_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ul_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ul_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ul_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>352</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3 </name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 4</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ul_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 5</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ul_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>pt_fac_price</name>
        <ascending>N</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>112</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 6</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ul_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 7</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ul_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 8</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ul_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>替换NULL值</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>pt_id</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>lo_viewed_notice</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>lo_delete_notice</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>944</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>表输出</name>
    <type>TableOutput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>d_date</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>create_time</column_name>
        <stream_name>ul_loan_time</stream_name>
      </field>
      <field>
        <column_name>d_datetime</column_name>
        <stream_name>d_datetime_1</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>d_year</column_name>
        <stream_name>d_year</stream_name>
      </field>
      <field>
        <column_name>d_month</column_name>
        <stream_name>d_month</stream_name>
      </field>
      <field>
        <column_name>d_half_year</column_name>
        <stream_name>d_half_year</stream_name>
      </field>
      <field>
        <column_name>d_quarter</column_name>
        <stream_name>d_quarter</stream_name>
      </field>
      <field>
        <column_name>d_day</column_name>
        <stream_name>d_day</stream_name>
      </field>
      <field>
        <column_name>d_hour</column_name>
        <stream_name>d_hour</stream_name>
      </field>
      <field>
        <column_name>d_sec</column_name>
        <stream_name>d_sec</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1072</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>排序记录</step1>
    <step2>排序记录 2</step2>
    <keys_1>
      <key>ul_id</key>
    </keys_1>
    <keys_2>
      <key>ul_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 2</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>字段选择 2</step1>
    <step2>排序记录 4</step2>
    <keys_1>
      <key>ul_id</key>
    </keys_1>
    <keys_2>
      <key>ul_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 3</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>排序记录 3</step1>
    <step2>排序记录 6</step2>
    <keys_1>
      <key>ul_id</key>
    </keys_1>
    <keys_2>
      <key>ul_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>560</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 4</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>记录集连接 3</step1>
    <step2>分组</step2>
    <keys_1>
      <key>ul_id</key>
    </keys_1>
    <keys_2>
      <key>ul_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>560</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 5</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>排序记录 7</step1>
    <step2>排序记录 8</step2>
    <keys_1>
      <key>ul_id</key>
    </keys_1>
    <keys_2>
      <key>ul_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>832</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 6</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>记录集连接 4</step1>
    <step2>JavaScript代码 3</step2>
    <keys_1>
      <key>ul_id</key>
    </keys_1>
    <keys_2>
      <key>ul_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>560</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 7</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>记录集连接 6</step1>
    <step2>user_notice</step2>
    <keys_1>
      <key>ul_id</key>
    </keys_1>
    <keys_2>
      <key>ul_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>832</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>过滤记录</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>字段选择 1</send_true_to>
    <send_false_to>JavaScript代码</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>d_id</leftvalue>
        <function>IS NOT NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>

<transformation>
  <info>
    <name>f_repayment</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/csl_ktrfile</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2018/07/19 13:55:37.000</created_date>
    <modified_user>admin</modified_user>
    <modified_date>2018/08/07 16:49:29.000</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>olap_db</name>
    <server>127.0.0.1</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>olap_db</database>
    <port>3306</port>
    <username>olap</username>
    <password>Encrypted 774ae5bce9b92dd0dccff23d8849e983a98f</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>risk_db</name>
    <server>rm-bp1392iiq3s3630q9.mysql.rds.aliyuncs.com</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>risk_db</database>
    <port>3306</port>
    <username>risk_user</username>
    <password>Encrypted 6e694c66465a443f37643a517371364885fbdcfc0de0c7c28c34ef4afed78891</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.characterEncoding</code>
        <attribute>utf8</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>she_db</name>
    <server>rm-bp1392iiq3s3630q9.mysql.rds.aliyuncs.com</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>she_db</database>
    <port>3306</port>
    <username>she_userv</username>
    <password>Encrypted 765a7537506b7332564a476d6e75285c91ab929303e4c1df925de44bc5c8b79b</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>JavaScript代码 4</from>
      <to>字段选择 3 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码 4</from>
      <to>排序记录 3  2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date 3</from>
      <to>排序记录 2 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date 2 2</from>
      <to>字段选择 5 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>去除重复记录 2</from>
      <to>表输出 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 1 2</from>
      <to>d_date 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 1 2</from>
      <to>排序记录 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 2 2</from>
      <to>合并记录 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 3 2</from>
      <to>记录集连接 2 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 4 2</from>
      <to>d_date 2 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 5 2</from>
      <to>合并记录 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 6</from>
      <to>记录集连接 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 2 2</from>
      <to>记录集连接 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3  2</from>
      <to>去除重复记录 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 4 2</from>
      <to>记录集连接 2 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>表输出 2</from>
      <to>排序记录 4 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 6</from>
      <to>过滤记录 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 2 2</from>
      <to>字段选择 4 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录 3</from>
      <to>JavaScript代码 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录 3</from>
      <to>字段选择 2 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_repayments 2</from>
      <to>字段选择 1 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_repayments 2</from>
      <to>f_user_basic 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>f_user_basic 2</from>
      <to>JavaScript代码 2 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码 2 2</from>
      <to>排序记录 3 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3 2</from>
      <to>记录集连接 3 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>合并记录 3</from>
      <to>记录集连接 3 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_phone_type 2</from>
      <to>排序记录 5 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_login_record 2</from>
      <to>d_phone_type 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组 2</from>
      <to>记录集连接 4 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 6 2</from>
      <to>user_login_record 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 5 2</from>
      <to>分组 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3 2</from>
      <to>字段选择 6 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3 2</from>
      <to>记录集连接 4 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 4 2</from>
      <to>字段选择 9</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 9</from>
      <to>user_debt 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_debt 2</from>
      <to>JavaScript代码 2 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码 2 3</from>
      <to>记录集连接 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 4 2</from>
      <to>记录集连接 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 7</from>
      <to>替换NULL值 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>替换NULL值 2</from>
      <to>f_repayment 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码</from>
      <to>字段选择 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码</from>
      <to>排序记录 3 </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码 2</from>
      <to>排序记录 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date</from>
      <to>排序记录 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date 2</from>
      <to>字段选择 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_phone_type</from>
      <to>排序记录 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>f_user_basic</from>
      <to>JavaScript代码 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_debt</from>
      <to>f_user_basic</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_debt</from>
      <to>字段选择 1</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_login_record</from>
      <to>d_phone_type</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组</from>
      <to>记录集连接 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>去除重复记录</from>
      <to>表输出</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>合并记录</from>
      <to>记录集连接 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>增加常量</from>
      <to>替换NULL值</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 1</from>
      <to>d_date</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 1</from>
      <to>排序记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 2</from>
      <to>合并记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 3</from>
      <to>记录集连接 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 4</from>
      <to>d_date 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 5</from>
      <to>合并记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 6</from>
      <to>user_login_record</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录</from>
      <to>记录集连接</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 2</from>
      <to>记录集连接</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3</from>
      <to>记录集连接 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3 </from>
      <to>去除重复记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 4</from>
      <to>记录集连接 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 5</from>
      <to>分组</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>替换NULL值</from>
      <to>f_repayment</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>表输出</from>
      <to>排序记录 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接</from>
      <to>过滤记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 2</from>
      <to>字段选择 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3</from>
      <to>字段选择 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3</from>
      <to>记录集连接 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 4</from>
      <to>增加常量</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录</from>
      <to>JavaScript代码</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录</from>
      <to>字段选择 2</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>JavaScript代码</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
function getNowFormatDate() {
    var date = new Date();
    var seperator1 = "-";
    var seperator2 = ":";
    var month = date.getMonth() + 1;
    var strDate = date.getDate();
    if (month >= 1 &amp;&amp; month &lt;= 9) {
        month = "0" + month;
    }
    if (strDate >= 0 &amp;&amp; strDate &lt;= 9) {
        strDate = "0" + strDate;
    }
    var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + date.getHours() + seperator2 + date.getMinutes()
            + seperator2 + date.getSeconds();
    return currentdate;
}
// 定义一个判断函数
function inArray(needle, haystack) {
    var length = haystack.length;
    for(var i = 0; i &lt; length; i++) {
        if(haystack[i] == needle) return true;
    }
    return false;
}
var cliname = 'SHE';
var org_id = 108;
var ctime = getNowFormatDate();
var d_year = ud_received_complete_time.substr(0,4);
var d_month = ud_received_complete_time.substr(5,2);
var arr = Array('01','02','03','04','05','06');
var is_half_year = inArray(d_month,arr);
if(is_half_year){
	var d_half_year = 0;
}else{
	var d_half_year = 1;
}
var quarter1 = inArray(d_month,Array('01','02','03'));
if(quarter1){
	var d_quarter = 1;
}
var quarter2 = inArray(d_month,Array('04','05','06'));
if(quarter2){
	var d_quarter = 2;
}
var quarter3 = inArray(d_month,Array('07','08','09'));
if(quarter3){
	var d_quarter = 3;
}
var quarter4 = inArray(d_month,Array('10','11','12'));
if(quarter4){
	var d_quarter = 4;
}
var d_day = ud_received_complete_time.substr(8,2);
var d_hour = ud_received_complete_time.substr(-8,2);
var d_sec = ud_received_complete_time.substr(-5,2);
var d_datetime = d_year+d_month+d_day+d_hour+d_sec;
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>cliname</name>
        <rename>cliname</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>org_id</name>
        <rename>org_id</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ctime</name>
        <rename>ctime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_year</name>
        <rename>d_year</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_month</name>
        <rename>d_month</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_half_year</name>
        <rename>d_half_year</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_quarter</name>
        <rename>d_quarter</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_day</name>
        <rename>d_day</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_hour</name>
        <rename>d_hour</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_sec</name>
        <rename>d_sec</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_datetime</name>
        <rename>d_datetime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JavaScript代码 2</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
var d_hour = ud_received_complete_time.substr(-8,2);
var d_min = ud_received_complete_time.substr(-5,2);
var d_sec = ud_received_complete_time.substr(-2,2);
var stamp = (d_hour*3600)+(d_min*60)+d_sec*1;
if(stamp>84600 || (stamp>=0 &amp;&amp; stamp&lt;=5400)){//1：[23:30:01-1:30:00]
	var r_time_type = 1;
}
if(stamp>5400 &amp;&amp; stamp&lt;=19800){//5：[1:30:01-5:30:00]
	var r_time_type = 5;
}
if(stamp>19800 &amp;&amp; stamp&lt;=32400){//9：[5:30:01~9:00:00]
	var r_time_type = 9;
}
if(stamp>32400 &amp;&amp; stamp&lt;=41400){//11：[9:00:01-11:30:00]
	var r_time_type = 11;
}
if(stamp>41400 &amp;&amp; stamp&lt;=48600){//13：[11:30:01-13:30:00]
	var r_time_type = 13;
}
if(stamp>48600 &amp;&amp; stamp&lt;=63000){//17：[13:30:01-17:30:00]
	var r_time_type = 17;
}
if(stamp>63000 &amp;&amp; stamp&lt;=70200){//19：[17:30:01-19:30:00]
	var r_time_type = 19;
}
if(stamp>70200 &amp;&amp; stamp&lt;=84600){//23：[19:30:01-23:30:00]
	var r_time_type = 23;
}



if(ud_notice_time!=0){
	var r_time_after_loan_reminder = Math.ceil((received_complete_time_stamp-ud_notice_time)/60/60);
	if(r_time_after_loan_reminder&lt;0){
		r_time_after_loan_reminder = -1;
	}
}else{
	var r_time_after_loan_reminder = -1;
}
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>r_time_type</name>
        <rename>r_time_type</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>r_time_after_loan_reminder</name>
        <rename>r_time_after_loan_reminder</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JavaScript代码 2 2</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
var d_hour = repay_time.substr(-8,2);
var d_min = repay_time.substr(-5,2);
var d_sec = repay_time.substr(-2,2);
var stamp = (d_hour*3600)+(d_min*60)+d_sec*1;
if(stamp>84600 || (stamp>=0 &amp;&amp; stamp&lt;=5400)){//1：[23:30:01-1:30:00]
	var r_time_type = 1;
}
if(stamp>5400 &amp;&amp; stamp&lt;=19800){//5：[1:30:01-5:30:00]
	var r_time_type = 5;
}
if(stamp>19800 &amp;&amp; stamp&lt;=32400){//9：[5:30:01~9:00:00]
	var r_time_type = 9;
}
if(stamp>32400 &amp;&amp; stamp&lt;=41400){//11：[9:00:01-11:30:00]
	var r_time_type = 11;
}
if(stamp>41400 &amp;&amp; stamp&lt;=48600){//13：[11:30:01-13:30:00]
	var r_time_type = 13;
}
if(stamp>48600 &amp;&amp; stamp&lt;=63000){//17：[13:30:01-17:30:00]
	var r_time_type = 17;
}
if(stamp>63000 &amp;&amp; stamp&lt;=70200){//19：[17:30:01-19:30:00]
	var r_time_type = 19;
}
if(stamp>70200 &amp;&amp; stamp&lt;=84600){//23：[19:30:01-23:30:00]
	var r_time_type = 23;
}

if(urs_behavior_type=='LR'){//主动还款
	var r_type = 0;
}else if(urs_behavior_type=='AR'){//自动扣款
	var r_type = 1;
}else if(urs_behavior_type=='00'){
	var r_type = 0;
}


if(urs_recv_status=='1'){
	var r_status = 1;
}else if(urs_recv_status=='2'){
	var r_status = 0;
}else{
	var r_status = -1;
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>r_time_type</name>
        <rename>r_time_type</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>r_type</name>
        <rename>r_type</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>r_status</name>
        <rename>r_status</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JavaScript代码 2 3</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
if(ud_notice_time!=0){
	var r_time_after_loan_reminder = Math.ceil((repay_time_stamp-ud_notice_time)/60/60);
	if(r_time_after_loan_reminder&lt;0){
		r_time_after_loan_reminder = -1;
	}
}else{
	var r_time_after_loan_reminder = -1;
}
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>r_time_after_loan_reminder</name>
        <rename>r_time_after_loan_reminder</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1136</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JavaScript代码 4</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
function getNowFormatDate() {
    var date = new Date();
    var seperator1 = "-";
    var seperator2 = ":";
    var month = date.getMonth() + 1;
    var strDate = date.getDate();
    if (month >= 1 &amp;&amp; month &lt;= 9) {
        month = "0" + month;
    }
    if (strDate >= 0 &amp;&amp; strDate &lt;= 9) {
        strDate = "0" + strDate;
    }
    var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + date.getHours() + seperator2 + date.getMinutes()
            + seperator2 + date.getSeconds();
    return currentdate;
}
// 定义一个判断函数
function inArray(needle, haystack) {
    var length = haystack.length;
    for(var i = 0; i &lt; length; i++) {
        if(haystack[i] == needle) return true;
    }
    return false;
}
var cliname = 'SHE';
var org_id = 108;
var ctime = getNowFormatDate();
var d_year = repay_time.substr(0,4);
var d_month = repay_time.substr(5,2);
var arr = Array('01','02','03','04','05','06');
var is_half_year = inArray(d_month,arr);
if(is_half_year){
	var d_half_year = 0;
}else{
	var d_half_year = 1;
}
var quarter1 = inArray(d_month,Array('01','02','03'));
if(quarter1){
	var d_quarter = 1;
}
var quarter2 = inArray(d_month,Array('04','05','06'));
if(quarter2){
	var d_quarter = 2;
}
var quarter3 = inArray(d_month,Array('07','08','09'));
if(quarter3){
	var d_quarter = 3;
}
var quarter4 = inArray(d_month,Array('10','11','12'));
if(quarter4){
	var d_quarter = 4;
}
var d_day = repay_time.substr(8,2);
var d_hour = repay_time.substr(-8,2);
var d_sec = repay_time.substr(-5,2);
var d_datetime = d_year+d_month+d_day+d_hour+d_sec;
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>cliname</name>
        <rename>cliname</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>org_id</name>
        <rename>org_id</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ctime</name>
        <rename>ctime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_year</name>
        <rename>d_year</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_month</name>
        <rename>d_month</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_half_year</name>
        <rename>d_half_year</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_quarter</name>
        <rename>d_quarter</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_day</name>
        <rename>d_day</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_hour</name>
        <rename>d_hour</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_sec</name>
        <rename>d_sec</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_datetime</name>
        <rename>d_datetime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
  d_id
,? as ud_id
, d_datetime
FROM d_date
where d_datetime=date_format(?,'%Y%m%d%H%i')</sql>
    <limit>0</limit>
    <lookup>字段选择 1</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
? as ud_id
, d_id
, d_datetime
FROM d_date
where d_datetime=?</sql>
    <limit>0</limit>
    <lookup>字段选择 4</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date 2 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
? as urs_id
, d_id
, d_datetime
FROM d_date
where d_datetime=?</sql>
    <limit>0</limit>
    <lookup>字段选择 4 2</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date 3</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
  d_id
,? as urs_id
, d_datetime
FROM d_date
where d_datetime=date_format(?,'%Y%m%d%H%i')</sql>
    <limit>0</limit>
    <lookup>字段选择 1 2</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_phone_type</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 ? as ud_id
, pt_id
, pt_fac_price
FROM d_phone_type
where pt_model=?
</sql>
    <limit>0</limit>
    <lookup>user_login_record</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_phone_type 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 ? as urs_id
, pt_id
, pt_fac_price
FROM d_phone_type
where pt_model=?
</sql>
    <limit>0</limit>
    <lookup>user_login_record 2</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_repayment</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>f_repayment</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>u_id</column_name>
        <stream_name>u_id</stream_name>
      </field>
      <field>
        <column_name>d_id</column_name>
        <stream_name>d_id</stream_name>
      </field>
      <field>
        <column_name>a_id</column_name>
        <stream_name>a_id</stream_name>
      </field>
      <field>
        <column_name>pt_id</column_name>
        <stream_name>pt_id</stream_name>
      </field>
      <field>
        <column_name>user_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>create_time</column_name>
        <stream_name>create_tme</stream_name>
      </field>
      <field>
        <column_name>r_time_after_loan_reminder</column_name>
        <stream_name>r_time_after_loan_reminder</stream_name>
      </field>
      <field>
        <column_name>r_type</column_name>
        <stream_name>r_type</stream_name>
      </field>
      <field>
        <column_name>r_time_type</column_name>
        <stream_name>r_time_type</stream_name>
      </field>
      <field>
        <column_name>r_ud_id</column_name>
        <stream_name>ud_id</stream_name>
      </field>
      <field>
        <column_name>r_ul_id</column_name>
        <stream_name>ul_id</stream_name>
      </field>
      <field>
        <column_name>r_status</column_name>
        <stream_name>r_status</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_repayment 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>f_repayment</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>u_id</column_name>
        <stream_name>u_id</stream_name>
      </field>
      <field>
        <column_name>d_id</column_name>
        <stream_name>d_id</stream_name>
      </field>
      <field>
        <column_name>a_id</column_name>
        <stream_name>a_id</stream_name>
      </field>
      <field>
        <column_name>pt_id</column_name>
        <stream_name>pt_id</stream_name>
      </field>
      <field>
        <column_name>user_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>create_time</column_name>
        <stream_name>create_tme</stream_name>
      </field>
      <field>
        <column_name>r_time_after_loan_reminder</column_name>
        <stream_name>r_time_after_loan_reminder</stream_name>
      </field>
      <field>
        <column_name>r_type</column_name>
        <stream_name>r_type</stream_name>
      </field>
      <field>
        <column_name>r_time_type</column_name>
        <stream_name>r_time_type</stream_name>
      </field>
      <field>
        <column_name>r_ud_id</column_name>
        <stream_name>ud_id</stream_name>
      </field>
      <field>
        <column_name>r_ul_id</column_name>
        <stream_name>ul_id</stream_name>
      </field>
      <field>
        <column_name>r_status</column_name>
        <stream_name>r_status</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1136</xloc>
      <yloc>1200</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_user_basic</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 ? as ud_id
, ? as ul_id
, u_id
, user_id_address_a_id as a_id
, u_user_id as user_id
, now() as create_tme
, cliname
, org_id
, ? as ud_status
, ? as ud_notice_time
, ? received_complete_time_stamp
, ? ud_received_complete_time
FROM f_user_basic
where org_id=? and u_user_id=?</sql>
    <limit>0</limit>
    <lookup>user_debt</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_user_basic 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 ? as urs_id
, u_id
, user_id_address_a_id as a_id
, u_user_id as user_id
, now() as create_tme
, cliname
, org_id
, ? as ud_id
, ? as ul_id
, ? repay_time_stamp
, ? repay_time
, ? as urs_behavior_type
, ? as urs_recv_status
FROM f_user_basic
where org_id=? and u_user_id=?</sql>
    <limit>0</limit>
    <lookup>user_repayments 2</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_debt</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>she_db</connection>
    <sql>SELECT
  ud_id
, ul_id
, ud_status
, ud_notice_time
, ud_received_complete_time as received_complete_time_stamp
, from_unixtime(ud_received_complete_time) as ud_received_complete_time
, org_id
, user_id
FROM user_debt where ud_status=2 limit 0,10000
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_debt 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>she_db</connection>
    <sql>SELECT
 ? as urs_id
, ? as repay_time_stamp
, ud_notice_time
FROM user_debt where ud_id=?
</sql>
    <limit>0</limit>
    <lookup>字段选择 9</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1136</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_login_record</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
 ? as ud_id
, ulgnr_vendor
FROM user_login_record
where org_id=? and user_id=? and ulgnr_vendor&lt;&gt;''
group by ulgnr_vendor
</sql>
    <limit>0</limit>
    <lookup>字段选择 6</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_login_record 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
 ? as urs_id
, ulgnr_vendor
FROM user_login_record
where org_id=? and user_id=? and ulgnr_vendor&lt;&gt;''
group by ulgnr_vendor
</sql>
    <limit>0</limit>
    <lookup>字段选择 6 2</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_repayments 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>she_db</connection>
    <sql>SELECT
urs_id
, ud_id
, ul_id
, create_time as repay_time_stamp
, from_unixtime(create_time) as repay_time
, urs_behavior_type
, urs_recv_status
, org_id
, user_id
FROM user_repayments where urs_behavior_type in('00','AR','LR') limit 0,10000
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>Y</give_back_row>
    <group>
      <field>
        <name>ud_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>pt_fac_price</aggregate>
        <subject>pt_fac_price</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>pt_id</aggregate>
        <subject>pt_id</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组 2</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>Y</give_back_row>
    <group>
      <field>
        <name>urs_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>pt_fac_price</aggregate>
        <subject>pt_fac_price</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>pt_id</aggregate>
        <subject>pt_id</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>去除重复记录</name>
    <type>Unique</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <count_rows>N</count_rows>
    <count_field/>
    <reject_duplicate_row>N</reject_duplicate_row>
    <error_description/>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <case_insensitive>N</case_insensitive>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>去除重复记录 2</name>
    <type>Unique</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <count_rows>N</count_rows>
    <count_field/>
    <reject_duplicate_row>N</reject_duplicate_row>
    <error_description/>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <case_insensitive>N</case_insensitive>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>合并记录</name>
    <type>MergeRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <keys>
      <key>ud_id</key>
    </keys>
    <values>
      <value>ud_id</value>
    </values>
    <flag_field>flagfield</flag_field>
    <reference>字段选择 2</reference>
    <compare>字段选择 5</compare>
    <compare>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>合并记录 3</name>
    <type>MergeRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <keys>
      <key>urs_id</key>
    </keys>
    <values>
      <value>urs_id</value>
    </values>
    <flag_field>flagfield</flag_field>
    <reference>字段选择 2 2</reference>
    <compare>字段选择 5 2</compare>
    <compare>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>增加常量</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>r_type</name>
        <type>Integer</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>2</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>r_status</name>
        <type>Integer</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>1</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>960</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 1</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>ud_received_complete_time</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>ud_received_complete_time</name>
        <rename>ud_received_complete_time</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd HH:mm:ss</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 1 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>urs_id</name>
      </field>
      <field>
        <name>repay_time</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>repay_time</name>
        <rename>repay_time</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd HH:mm:ss</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 2 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>urs_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 3</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>d_datetime_1</name>
        <rename>d_datetime</rename>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 3 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>urs_id</name>
      </field>
      <field>
        <name>d_datetime_1</name>
        <rename>d_datetime</rename>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>1280</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 4</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 4 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>urs_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 5</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>ud_id</name>
        <rename>ud_id</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 5 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>urs_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>urs_id</name>
        <rename>urs_id</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 6</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ud_id</name>
      </field>
      <field>
        <name>org_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 6 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>urs_id</name>
      </field>
      <field>
        <name>org_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 9</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>urs_id</name>
      </field>
      <field>
        <name>repay_time_stamp</name>
      </field>
      <field>
        <name>ud_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 2 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>urs_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3 </name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3  2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>urs_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 4</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 4 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>urs_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 5</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ud_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>pt_fac_price</name>
        <ascending>N</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 5 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>urs_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>pt_fac_price</name>
        <ascending>N</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 6</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>urs_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>替换NULL值</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>pt_id</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>r_type</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1072</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>替换NULL值 2</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>pt_id</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1136</xloc>
      <yloc>1088</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>表输出</name>
    <type>TableOutput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>d_date</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>create_time</column_name>
        <stream_name>ud_received_complete_time</stream_name>
      </field>
      <field>
        <column_name>d_datetime</column_name>
        <stream_name>d_datetime_1</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>d_year</column_name>
        <stream_name>d_year</stream_name>
      </field>
      <field>
        <column_name>d_month</column_name>
        <stream_name>d_month</stream_name>
      </field>
      <field>
        <column_name>d_half_year</column_name>
        <stream_name>d_half_year</stream_name>
      </field>
      <field>
        <column_name>d_quarter</column_name>
        <stream_name>d_quarter</stream_name>
      </field>
      <field>
        <column_name>d_day</column_name>
        <stream_name>d_day</stream_name>
      </field>
      <field>
        <column_name>d_hour</column_name>
        <stream_name>d_hour</stream_name>
      </field>
      <field>
        <column_name>d_sec</column_name>
        <stream_name>d_sec</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>表输出 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>d_date</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>create_time</column_name>
        <stream_name>repay_time</stream_name>
      </field>
      <field>
        <column_name>d_datetime</column_name>
        <stream_name>d_datetime_1</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>d_year</column_name>
        <stream_name>d_year</stream_name>
      </field>
      <field>
        <column_name>d_month</column_name>
        <stream_name>d_month</stream_name>
      </field>
      <field>
        <column_name>d_half_year</column_name>
        <stream_name>d_half_year</stream_name>
      </field>
      <field>
        <column_name>d_quarter</column_name>
        <stream_name>d_quarter</stream_name>
      </field>
      <field>
        <column_name>d_day</column_name>
        <stream_name>d_day</stream_name>
      </field>
      <field>
        <column_name>d_hour</column_name>
        <stream_name>d_hour</stream_name>
      </field>
      <field>
        <column_name>d_sec</column_name>
        <stream_name>d_sec</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>排序记录</step1>
    <step2>排序记录 2</step2>
    <keys_1>
      <key>ud_id</key>
    </keys_1>
    <keys_2>
      <key>ud_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 2</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>字段选择 3</step1>
    <step2>排序记录 4</step2>
    <keys_1>
      <key>ud_id</key>
    </keys_1>
    <keys_2>
      <key>ud_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 2 2</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>字段选择 3 2</step1>
    <step2>排序记录 4 2</step2>
    <keys_1>
      <key>urs_id</key>
    </keys_1>
    <keys_2>
      <key>urs_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>1280</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 3</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>排序记录 3</step1>
    <step2>合并记录</step2>
    <keys_1>
      <key>ud_id</key>
    </keys_1>
    <keys_2>
      <key>ud_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 3 2</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>排序记录 3 2</step1>
    <step2>合并记录 3</step2>
    <keys_1>
      <key>urs_id</key>
    </keys_1>
    <keys_2>
      <key>urs_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>960</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 4</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>记录集连接 3</step1>
    <step2>分组</step2>
    <keys_1>
      <key>ud_id</key>
    </keys_1>
    <keys_2>
      <key>ud_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 4 2</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>记录集连接 3 2</step1>
    <step2>分组 2</step2>
    <keys_1>
      <key>urs_id</key>
    </keys_1>
    <keys_2>
      <key>urs_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>960</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 6</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>排序记录 6</step1>
    <step2>排序记录 2 2</step2>
    <keys_1>
      <key>urs_id</key>
    </keys_1>
    <keys_2>
      <key>urs_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>1280</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 7</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>记录集连接 4 2</step1>
    <step2>JavaScript代码 2 3</step2>
    <keys_1>
      <key>urs_id</key>
    </keys_1>
    <keys_2>
      <key>urs_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1136</xloc>
      <yloc>960</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>过滤记录</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>字段选择 2</send_true_to>
    <send_false_to>JavaScript代码</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>d_id</leftvalue>
        <function>IS NOT NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>过滤记录 3</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>字段选择 2 2</send_true_to>
    <send_false_to>JavaScript代码 4</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>d_id</leftvalue>
        <function>IS NOT NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>1280</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>

<transformation>
  <info>
    <name>f_trans_st</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/csl_ktrfile</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2018/07/20 09:28:34.000</created_date>
    <modified_user>admin</modified_user>
    <modified_date>2018/08/10 15:42:43.000</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>olap_db</name>
    <server>127.0.0.1</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>olap_db</database>
    <port>3306</port>
    <username>olap</username>
    <password>Encrypted 774ae5bce9b92dd0dccff23d8849e983a98f</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>risk_db</name>
    <server>rm-bp1392iiq3s3630q9.mysql.rds.aliyuncs.com</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>risk_db</database>
    <port>3306</port>
    <username>risk_user</username>
    <password>Encrypted 6e694c66465a443f37643a517371364885fbdcfc0de0c7c28c34ef4afed78891</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.characterEncoding</code>
        <attribute>utf8</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>she_db</name>
    <server>rm-bp1392iiq3s3630q9.mysql.rds.aliyuncs.com</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>she_db</database>
    <port>3306</port>
    <username>she_userv</username>
    <password>Encrypted 765a7537506b7332564a476d6e75285c91ab929303e4c1df925de44bc5c8b79b</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>JavaScript代码 2</from>
      <to>字段选择 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码 2</from>
      <to>排序记录 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date</from>
      <to>排序记录 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_date 2</from>
      <to>字段选择 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>去除重复记录</from>
      <to>表输出</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 2</from>
      <to>记录集连接 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 4</from>
      <to>d_date 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择</from>
      <to>d_date</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择</from>
      <to>排序记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 1</from>
      <to>合并记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 3</from>
      <to>合并记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录</from>
      <to>记录集连接</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 4</from>
      <to>记录集连接 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 2</from>
      <to>记录集连接</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 3</from>
      <to>去除重复记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>表输出</from>
      <to>排序记录 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接</from>
      <to>过滤记录</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 3</from>
      <to>字段选择 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录</from>
      <to>JavaScript代码 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>过滤记录</from>
      <to>字段选择 1</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>f_user_basic</from>
      <to>字段选择</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>f_user_basic</from>
      <to>记录集连接 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>d_phone_type</from>
      <to>排序记录 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_login_record</from>
      <to>d_phone_type</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 6</from>
      <to>user_login_record</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 6</from>
      <to>分组</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>合并记录</from>
      <to>排序记录 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>排序记录 5</from>
      <to>记录集连接 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 2</from>
      <to>字段选择 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 2</from>
      <to>记录集连接 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组</from>
      <to>记录集连接 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 4</from>
      <to>字段选择 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 5</from>
      <to>user_loan</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_loan</from>
      <to>字段选择 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 7</from>
      <to>JavaScript代码</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JavaScript代码</from>
      <to>分组 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 4</from>
      <to>记录集连接 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组 2</from>
      <to>记录集连接 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 5</from>
      <to>字段选择 8</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 5</from>
      <to>记录集连接 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>记录集连接 6</from>
      <to>替换NULL值</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>替换NULL值</from>
      <to>f_trans_st</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>user_visa_record</from>
      <to>分组 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>字段选择 8</from>
      <to>user_visa_record</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>分组 3</from>
      <to>记录集连接 6</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>JavaScript代码</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
var ts_ul_cnt_0130 = 0;
var ts_ul_cnt_0530 = 0;
var ts_ul_cnt_0900 = 0;
var ts_ul_cnt_1130 = 0;
var ts_ul_cnt_1330 = 0;
var ts_ul_cnt_1730 = 0;
var ts_ul_cnt_1930 = 0;
var ts_ul_cnt_2300 = 0;
	var d_hour = ul_loan_time.substr(-8,2);
	var d_min = ul_loan_time.substr(-5,2);
	var d_sec = ul_loan_time.substr(-2,2);
	var stamp = (d_hour*3600)+(d_min*60)+d_sec*1;
	if(stamp>84600 || (stamp>=0 &amp;&amp; stamp&lt;=5400)){//1：[23:30:01-1:30:00]
		ts_ul_cnt_0130 = 1;
	}
	if(stamp>5400 &amp;&amp; stamp&lt;=19800){//5：[1:30:01-5:30:00]
		ts_ul_cnt_0530 = 1;
	}
	if(stamp>19800 &amp;&amp; stamp&lt;=32400){//9：[5:30:01~9:00:00]
		ts_ul_cnt_0900 = 1;
	}
	if(stamp>32400 &amp;&amp; stamp&lt;=41400){//11：[9:00:01-11:30:00]
		ts_ul_cnt_1130 = 1;
	}
	if(stamp>41400 &amp;&amp; stamp&lt;=48600){//13：[11:30:01-13:30:00]
		ts_ul_cnt_1330 = 1;
	}
	if(stamp>48600 &amp;&amp; stamp&lt;=63000){//17：[13:30:01-17:30:00]
		ts_ul_cnt_1730 = 1;
	}
	if(stamp>63000 &amp;&amp; stamp&lt;=70200){//19：[17:30:01-19:30:00]
		var ts_ul_cnt_1930 = 1;
	}
	if(stamp>70200 &amp;&amp; stamp&lt;=84600){//23：[19:30:01-23:30:00]
		ts_ul_cnt_2300 = 1;
	}

var ts_ur_cnt_0130 = 0;
var ts_ur_cnt_0530 = 0;
var ts_ur_cnt_0900 = 0;
var ts_ur_cnt_1130 = 0;
var ts_ur_cnt_1330 = 0;
var ts_ur_cnt_1730 = 0;
var ts_ur_cnt_1930 = 0;
var ts_ur_cnt_2300 = 0;
if(ul_repay_complete_time!=null){
	var d_hour1 = ul_repay_complete_time.substr(-8,2);
	var d_min1 = ul_repay_complete_time.substr(-5,2);
	var d_sec1 = ul_repay_complete_time.substr(-2,2);
	var stamp1 = (d_hour1*3600)+(d_min1*60)+d_sec1*1;
	if(stamp1>84600 || (stamp1>=0 &amp;&amp; stamp1&lt;=5400)){//1：[23:30:01-1:30:00]
		ts_ur_cnt_0130 = 1;
	}
	if(stamp1>5400 &amp;&amp; stamp1&lt;=19800){//5：[1:30:01-5:30:00]
		ts_ur_cnt_0530 = 1;
	}
	if(stamp1>19800 &amp;&amp; stamp1&lt;=32400){//9：[5:30:01~9:00:00]
		ts_ur_cnt_0900 = 1;
	}
	if(stamp1>32400 &amp;&amp; stamp1&lt;=41400){//11：[9:00:01-11:30:00]
		ts_ur_cnt_1130 = 1;
	}
	if(stamp1>41400 &amp;&amp; stamp1&lt;=48600){//13：[11:30:01-13:30:00]
		ts_ur_cnt_1330 = 1;
	}
	if(stamp1>48600 &amp;&amp; stamp1&lt;=63000){//17：[13:30:01-17:30:00]
		ts_ur_cnt_1730 = 1;
	}
	if(stamp1>63000 &amp;&amp; stamp1&lt;=70200){//19：[17:30:01-19:30:00]
		ts_ur_cnt_1930 = 1;
	}
	if(stamp1>70200 &amp;&amp; stamp1&lt;=84600){//23：[19:30:01-23:30:00]
		ts_ur_cnt_2300 = 1;
	}
}


var ts_ur_cnt=0;
if(ul_loan_status==3){
	var ts_ur_cnt=1;
}
var ts_overdue_cnt = 0;
if(ul_overdue_daycount>0){
	var ts_overdue_cnt = 1;
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>ts_ul_cnt_0130</name>
        <rename>ts_ul_cnt_0130</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ul_cnt_0530</name>
        <rename>ts_ul_cnt_0530</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ul_cnt_0900</name>
        <rename>ts_ul_cnt_0900</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ul_cnt_1130</name>
        <rename>ts_ul_cnt_1130</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ul_cnt_1330</name>
        <rename>ts_ul_cnt_1330</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ul_cnt_1730</name>
        <rename>ts_ul_cnt_1730</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ul_cnt_1930</name>
        <rename>ts_ul_cnt_1930</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ul_cnt_2300</name>
        <rename>ts_ul_cnt_2300</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ur_cnt_0130</name>
        <rename>ts_ur_cnt_0130</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ur_cnt_0530</name>
        <rename>ts_ur_cnt_0530</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ur_cnt_0900</name>
        <rename>ts_ur_cnt_0900</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ur_cnt_1130</name>
        <rename>ts_ur_cnt_1130</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ur_cnt_1330</name>
        <rename>ts_ur_cnt_1330</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ur_cnt_1730</name>
        <rename>ts_ur_cnt_1730</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ur_cnt_1930</name>
        <rename>ts_ur_cnt_1930</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ur_cnt_2300</name>
        <rename>ts_ur_cnt_2300</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_ur_cnt</name>
        <rename>ts_ur_cnt</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ts_overdue_cnt</name>
        <rename>ts_overdue_cnt</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JavaScript代码 2</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
function getNowFormatDate() {
    var date = new Date();
    var seperator1 = "-";
    var seperator2 = ":";
    var month = date.getMonth() + 1;
    var strDate = date.getDate();
    if (month >= 1 &amp;&amp; month &lt;= 9) {
        month = "0" + month;
    }
    if (strDate >= 0 &amp;&amp; strDate &lt;= 9) {
        strDate = "0" + strDate;
    }
    var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + date.getHours() + seperator2 + date.getMinutes()
            + seperator2 + date.getSeconds();
    return currentdate;
}
// 定义一个判断函数
function inArray(needle, haystack) {
    var length = haystack.length;
    for(var i = 0; i &lt; length; i++) {
        if(haystack[i] == needle) return true;
    }
    return false;
}
var cliname = 'SHE';
var org_id = 108;
var ctime = getNowFormatDate();
var d_year = create_time.substr(0,4);
var d_month = create_time.substr(5,2);
var arr = Array('01','02','03','04','05','06');
var is_half_year = inArray(d_month,arr);
if(is_half_year){
	var d_half_year = 0;
}else{
	var d_half_year = 1;
}
var quarter1 = inArray(d_month,Array('01','02','03'));
if(quarter1){
	var d_quarter = 1;
}
var quarter2 = inArray(d_month,Array('04','05','06'));
if(quarter2){
	var d_quarter = 2;
}
var quarter3 = inArray(d_month,Array('07','08','09'));
if(quarter3){
	var d_quarter = 3;
}
var quarter4 = inArray(d_month,Array('10','11','12'));
if(quarter4){
	var d_quarter = 4;
}
var d_day = create_time.substr(8,2);
var d_hour = create_time.substr(-8,2);
var d_sec = create_time.substr(-5,2);
var d_datetime = d_year+d_month+d_day+d_hour+d_sec;
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>cliname</name>
        <rename>cliname</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>org_id</name>
        <rename>org_id</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ctime</name>
        <rename>ctime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_year</name>
        <rename>d_year</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_month</name>
        <rename>d_month</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_half_year</name>
        <rename>d_half_year</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_quarter</name>
        <rename>d_quarter</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_day</name>
        <rename>d_day</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_hour</name>
        <rename>d_hour</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_sec</name>
        <rename>d_sec</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>d_datetime</name>
        <rename>d_datetime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
  d_id
,? as u_id
, d_datetime
FROM d_date
where d_datetime=date_format(?,'%Y%m%d%H%i')</sql>
    <limit>0</limit>
    <lookup>字段选择</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>320</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_date 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
? as u_id
, d_id
, d_datetime
FROM d_date
where d_datetime=?</sql>
    <limit>0</limit>
    <lookup>字段选择 4</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>d_phone_type</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
 ? as u_id
, pt_id
, pt_fac_price
FROM d_phone_type
where pt_model=?
</sql>
    <limit>0</limit>
    <lookup>user_login_record</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>112</xloc>
      <yloc>736</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_trans_st</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>f_trans_st</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>u_id</column_name>
        <stream_name>u_id</stream_name>
      </field>
      <field>
        <column_name>pt_id</column_name>
        <stream_name>pt_id</stream_name>
      </field>
      <field>
        <column_name>d_id</column_name>
        <stream_name>d_id</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>create_time</column_name>
        <stream_name>create_time</stream_name>
      </field>
      <field>
        <column_name>user_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>ts_ul_cnt</column_name>
        <stream_name>ts_ul_cnt</stream_name>
      </field>
      <field>
        <column_name>ts_ur_cnt</column_name>
        <stream_name>ts_ur_cnt</stream_name>
      </field>
      <field>
        <column_name>ts_ul_cnt_0130</column_name>
        <stream_name>ts_ul_cnt_0130</stream_name>
      </field>
      <field>
        <column_name>ts_ul_cnt_0530</column_name>
        <stream_name>ts_ul_cnt_0530</stream_name>
      </field>
      <field>
        <column_name>ts_ul_cnt_0900</column_name>
        <stream_name>ts_ul_cnt_0900</stream_name>
      </field>
      <field>
        <column_name>ts_ul_cnt_1130</column_name>
        <stream_name>ts_ul_cnt_1130</stream_name>
      </field>
      <field>
        <column_name>ts_ul_cnt_1330</column_name>
        <stream_name>ts_ul_cnt_1330</stream_name>
      </field>
      <field>
        <column_name>ts_ul_cnt_1730</column_name>
        <stream_name>ts_ul_cnt_1730</stream_name>
      </field>
      <field>
        <column_name>ts_ul_cnt_1930</column_name>
        <stream_name>ts_ul_cnt_1930</stream_name>
      </field>
      <field>
        <column_name>ts_ul_cnt_2300</column_name>
        <stream_name>ts_ul_cnt_2300</stream_name>
      </field>
      <field>
        <column_name>ts_ur_cnt_0130</column_name>
        <stream_name>ts_ur_cnt_0130</stream_name>
      </field>
      <field>
        <column_name>ts_ur_cnt_0530</column_name>
        <stream_name>ts_ur_cnt_0530</stream_name>
      </field>
      <field>
        <column_name>ts_ur_cnt_0900</column_name>
        <stream_name>ts_ur_cnt_0900</stream_name>
      </field>
      <field>
        <column_name>ts_ur_cnt_1130</column_name>
        <stream_name>ts_ur_cnt_1130</stream_name>
      </field>
      <field>
        <column_name>ts_ur_cnt_1330</column_name>
        <stream_name>ts_ur_cnt_1330</stream_name>
      </field>
      <field>
        <column_name>ts_ur_cnt_1730</column_name>
        <stream_name>ts_ur_cnt_1730</stream_name>
      </field>
      <field>
        <column_name>ts_ur_cnt_1930</column_name>
        <stream_name>ts_ur_cnt_1930</stream_name>
      </field>
      <field>
        <column_name>ts_ur_cnt_2300</column_name>
        <stream_name>ts_ur_cnt_2300</stream_name>
      </field>
      <field>
        <column_name>ts_overdue_cnt</column_name>
        <stream_name>ts_overdue_cnt</stream_name>
      </field>
      <field>
        <column_name>ts_max_overdue_daycnt</column_name>
        <stream_name>ts_max_overdue_daycnt</stream_name>
      </field>
      <field>
        <column_name>ts_bankcard_unique_cnt</column_name>
        <stream_name>ts_bankcard_unique_cnt</stream_name>
      </field>
      <field>
        <column_name>ts_bankcard_cnt</column_name>
        <stream_name>ts_bankcard_cnt</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>1072</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>f_user_basic</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <sql>SELECT
  u_id
, cliname
, org_id
, create_time
, u_user_id as user_id
FROM f_user_basic where cliname='SHE' limit 110000,10000</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>112</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_loan</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>she_db</connection>
    <sql>SELECT
 ? as u_id
, user_id
, ul_loan_status
, from_unixtime(ul_loan_time) as ul_loan_time
, if(ul_repay_complete_time=0,null,from_unixtime(ul_repay_complete_time)) as ul_repay_complete_time
, ul_overdue_daycount
FROM user_loan where org_id=? and user_id=? and ul_loan_status in(2,3) and ul_loan_time&lt;unix_timestamp('2018-07-19 00:00:00')
</sql>
    <limit>0</limit>
    <lookup>字段选择 5</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>624</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_login_record</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
 ? as u_id
, ulgnr_vendor
FROM user_login_record
where org_id=? and user_id=? and ulgnr_vendor&lt;&gt;''
group by ulgnr_vendor
</sql>
    <limit>0</limit>
    <lookup>字段选择 6</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>112</xloc>
      <yloc>624</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_visa_record</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>risk_db</connection>
    <sql>SELECT
 ? as u_id
, uvar_no
FROM user_visa_record where user_id=? and org_id=?
</sql>
    <limit>0</limit>
    <lookup>字段选择 8</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>736</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>Y</give_back_row>
    <group>
      <field>
        <name>u_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>pt_fac_price</aggregate>
        <subject>pt_fac_price</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>pt_id</aggregate>
        <subject>pt_id</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>624</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组 2</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>u_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>ts_ul_cnt</aggregate>
        <subject>user_id</subject>
        <type>COUNT_ALL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ur_cnt</aggregate>
        <subject>ts_ur_cnt</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ul_cnt_0130</aggregate>
        <subject>ts_ul_cnt_0130</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ul_cnt_0530</aggregate>
        <subject>ts_ul_cnt_0530</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ul_cnt_0900</aggregate>
        <subject>ts_ul_cnt_0900</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ul_cnt_1130</aggregate>
        <subject>ts_ul_cnt_1130</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ul_cnt_1330</aggregate>
        <subject>ts_ul_cnt_1330</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ul_cnt_1730</aggregate>
        <subject>ts_ul_cnt_1730</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ul_cnt_1930</aggregate>
        <subject>ts_ul_cnt_1930</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ul_cnt_2300</aggregate>
        <subject>ts_ul_cnt_2300</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ur_cnt_0130</aggregate>
        <subject>ts_ur_cnt_0130</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ur_cnt_0530</aggregate>
        <subject>ts_ur_cnt_0530</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ur_cnt_0900</aggregate>
        <subject>ts_ur_cnt_0900</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ur_cnt_1130</aggregate>
        <subject>ts_ur_cnt_1130</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ur_cnt_1330</aggregate>
        <subject>ts_ur_cnt_1330</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ur_cnt_1730</aggregate>
        <subject>ts_ur_cnt_1730</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ur_cnt_1930</aggregate>
        <subject>ts_ur_cnt_1930</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_ur_cnt_2300</aggregate>
        <subject>ts_ur_cnt_2300</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_overdue_cnt</aggregate>
        <subject>ts_overdue_cnt</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_max_overdue_daycnt</aggregate>
        <subject>ul_overdue_daycount</subject>
        <type>MAX</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>656</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>分组 3</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>u_id</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>ts_bankcard_unique_cnt</aggregate>
        <subject>uvar_no</subject>
        <type>COUNT_DISTINCT</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ts_bankcard_cnt</aggregate>
        <subject>uvar_no</subject>
        <type>COUNT_ALL</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>去除重复记录</name>
    <type>Unique</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <count_rows>N</count_rows>
    <count_field/>
    <reject_duplicate_row>N</reject_duplicate_row>
    <error_description/>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <case_insensitive>N</case_insensitive>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>合并记录</name>
    <type>MergeRows</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <keys>
      <key>u_id</key>
    </keys>
    <values>
      <value>u_id</value>
    </values>
    <flag_field>flagfield</flag_field>
    <reference>字段选择 1</reference>
    <compare>字段选择 3</compare>
    <compare>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>640</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>create_time</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>create_time</name>
        <rename>create_time</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd HH:mm:ss</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>320</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 1</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>d_datetime_1</name>
        <rename>d_datetime</rename>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>640</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 3</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>d_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>u_id</name>
        <rename>u_id</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>752</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 4</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>d_datetime</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 5</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>org_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 6</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>org_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>112</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 7</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <field>
        <name>ul_loan_status</name>
      </field>
      <field>
        <name>ul_loan_time</name>
      </field>
      <field>
        <name>ul_repay_complete_time</name>
      </field>
      <field>
        <name>ul_overdue_daycount</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>ul_loan_time</name>
        <rename>ul_loan_time</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd HH:mm:ss</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>ul_repay_complete_time</name>
        <rename>ul_repay_complete_time</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd HH:mm:ss</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>752</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>字段选择 8</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>u_id</name>
      </field>
      <field>
        <name>user_id</name>
      </field>
      <field>
        <name>org_id</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>736</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>Y</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>Y</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 3</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>d_datetime_1</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>640</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 4</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 5</name>
    <type>SortRows</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>640</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>排序记录 6</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>u_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>pt_fac_price</name>
        <ascending>N</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>736</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>替换NULL值</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>pt_id</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>ts_bankcard_unique_cnt</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>ts_bankcard_cnt</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>960</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>表输出</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>olap_db</connection>
    <schema/>
    <table>d_date</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>create_time</column_name>
        <stream_name>create_time</stream_name>
      </field>
      <field>
        <column_name>d_datetime</column_name>
        <stream_name>d_datetime_1</stream_name>
      </field>
      <field>
        <column_name>cliname</column_name>
        <stream_name>cliname</stream_name>
      </field>
      <field>
        <column_name>org_id</column_name>
        <stream_name>org_id</stream_name>
      </field>
      <field>
        <column_name>d_year</column_name>
        <stream_name>d_year</stream_name>
      </field>
      <field>
        <column_name>d_month</column_name>
        <stream_name>d_month</stream_name>
      </field>
      <field>
        <column_name>d_half_year</column_name>
        <stream_name>d_half_year</stream_name>
      </field>
      <field>
        <column_name>d_quarter</column_name>
        <stream_name>d_quarter</stream_name>
      </field>
      <field>
        <column_name>d_day</column_name>
        <stream_name>d_day</stream_name>
      </field>
      <field>
        <column_name>d_hour</column_name>
        <stream_name>d_hour</stream_name>
      </field>
      <field>
        <column_name>d_sec</column_name>
        <stream_name>d_sec</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>排序记录</step1>
    <step2>排序记录 2</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 2</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>f_user_basic</step1>
    <step2>排序记录 5</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>112</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 3</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>字段选择 2</step1>
    <step2>排序记录 4</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>768</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 4</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>记录集连接 2</step1>
    <step2>分组</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 5</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>记录集连接 4</step1>
    <step2>分组 2</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>656</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>记录集连接 6</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>LEFT OUTER</join_type>
    <step1>记录集连接 5</step1>
    <step2>分组 3</step2>
    <keys_1>
      <key>u_id</key>
    </keys_1>
    <keys_2>
      <key>u_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>过滤记录</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>字段选择 1</send_true_to>
    <send_false_to>JavaScript代码 2</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>d_id</leftvalue>
        <function>IS NOT NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>

</transformations>
</repository>

